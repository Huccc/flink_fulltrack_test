package com.huc.flinksql_cuschk;

import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.table.api.bridge.java.StreamTableEnvironment;

public class letpastest {
    public static void main(String[] args) {
        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
        StreamTableEnvironment tEnv = StreamTableEnvironment.create(env);
        env.setParallelism(1);
        tEnv.executeSql("" +
                "CREATE TABLE sourceTB (\n" +
                "  msgId STRING,\n" +
                "  bizId STRING,\n" +
                "  msgType STRING,\n" +
                "  bizUniqueId STRING,\n" +
                "  destination STRING,\n" +
                "  parseData STRING,\n" +
                "  LASTUPDATEDDT AS PROCTIME() + INTERVAL '8' HOUR\n" +
                ") WITH (\n" +
                "  'connector' = 'kafka',\n" +
                "  'topic' = 'topic-bdpcollect-db-parse-result',\n" +
                "  'properties.bootstrap.servers' = '192.168.129.121:9092,192.168.129.122:9092,192.168.129.123:9092',\n" +
                "  'properties.group.id' = 'flink-sql-full-link-tracing-letpas',\n" +
                "  'format' = 'json',\n" +
                "  'scan.startup.mode' = 'group-offsets'\n" +
                ")");

        tEnv.executeSql("" +
                "insert into sourceTB(msgId,bizId,msgType,bizUniqueId,destination,parseData) " +
                "select '1359023762372042843' as msgId," +
                "'ogg_data' as bizId," +
                "'null' as msgType," +
                "'null' as bizUniqueId," +
                "'SRC_XIB3.EDI_CUSCHK_BILLINFO' as destination," +
                "'{\"ID\":98304,\"VESSELNAME_CN\":\"亿通测试\",\"VESSELNAME_EN\":\"EP TEST SHIP\",\"IMO_NO\":\"10000003\",\"MSA_VESSEL_CODE\":\"B9999999\",\"BUSSINESS_TYPE\":\"01\",\"VOYAGE_IN\":\"9999SI\",\"VOYAGE_OUT\":\"9999SO\",\"START_PORT_CODE\":\"CNTAO\",\"START_PORT_NAME\":\"青岛\",\"MSA_PRE_PORT_CODE\":\"CNTAO\",\"MSA_PRE_PORT_NAME\":\"青岛\",\"CUS_PRE_PORT_CODE\":\"CNQDP\",\"CUS_PRE_PORT_NAME\":\"青岛港\",\"CII_PRE_PORT_NAME\":\"青岛\",\"PRE_PASSCODE\":null,\"CUS_ARRIVAL_PORT_CODE\":\"CNSHG\",\"ARRIVAL_DATE\":\"2018-05-16 02:30:00\",\"MSA_VESSEL_DIRECTION\":\"1\",\"CUS_VESSEL_DIRECTION\":\"抵港\",\"MSA_BERTH_CODE\":\"0190266\",\"MSA_BERTH_NAME\":\"上海浦东外四1泊位\",\"CIQ_BERTH_CODE\":\"234\",\"CIQ_BERTH_NAME\":\"外4期4\",\"CUS_BERTH_CODE\":\"00038\",\"CUS_BERTH_NAME\":\"上海沪东集装箱码头管理公司（外高桥4期）\",\"CII_BERTH_CODE\":\"306_3_2\",\"CII_BERTH_NAME\":\"外四期_2号\",\"CUS_ENTER_PURPOSE\":\"1\",\"DEEP_DRAFT\":9.5,\"FRONT_DRAFT\":9.1,\"REAR_DRAFT\":9.5,\"CN_M_PASSENGER\":0,\"CN_F_PASSENGER\":0,\"FOR_M_PASSENGER\":0,\"FOR_F_PASSENGER\":0,\"PORT_PASSENGER\":0,\"CN_SAILOR\":18,\"FOR_SAILOR\":0,\"FACT_CARGO_WEIGHT\":4209,\"PORT_LOAD_CARGO\":\"Y\",\"TOTAL_CARGO_WEIGHT\":4209,\"DANGEROUS_CARGO_WEIGHT\":0,\"CUS_CORP_CODE\":null,\"CUS_CORP_TYPE_CODE\":\"4\",\"MANAGE_LINE\":null,\"LIGHTER_FLAG\":\"1\",\"BARGE_NUMBER\":null,\"BIND_BARGE_NUMBER\":null,\"COMPLEMENT\":20,\"CAPTAIN_NAME\":\"陈磊\",\"USER_NAME\":\"刘斌\",\"AGENT_CORP_ADDR\":\"东大名路948号白金湾广场9楼\",\"PSC\":\"1\",\"LAST_CHECK_DATE\":null,\"LAST_CHECK_PLACE\":null,\"REINSPECT_ITEM\":\"0\",\"DECLARATION\":\"上海海事局：兹申明我船证书齐备，处于适航状态，船员配备及货物装载符合要求，申请材料准确无误！\",\"CHECK_DATE\":\"2018-05-14 00:00:00\",\"AUDITNO_24\":\"YOV1805150125\",\"MEMO\":null,\"CREATEDATE\":\"2018-05-15 16:26:10\",\"EDITDATE\":\"2018-05-16 16:02:50.000000000\",\"OPERATOR_ID\":\"shipdec044\",\"ORG_ID\":\"717883365\",\"RECORD_STATUS\":\"1\",\"DOC_STATUS\":\"B\",\"CUS_ARV_APLID\":\"SEA_SWA00000000000000504105\",\"CUS_AGENT_CODE\":\"2200717883365\",\"CUS_ARV_SEND_TIME\":\"2018-05-16 02:39:08\",\"CUS_ARV_RECV_TIME\":\"2018-05-16 02:43:47\",\"CUS_ARV_ADD_STATUS\":\"ACC\",\"CUS_ARV_MOD_STATUS\":null,\"CUS_ARV_REPLY_MEMO\":\"自动审单通过\",\"CUS_APP_APLID\":\"SEA_SWD00000000000000504106\",\"CUS_APP_SEND_TIME\":\"2018-05-16 04:14:38\",\"CUS_APP_RECV_TIME\":\"2018-05-16 16:08:46\",\"CUS_APP_ADD_STATUS\":\"ACC\",\"CUS_APP_MOD_STATUS\":null,\"CUS_APP_REPLY_MEMO\":null,\"MSA_APLID\":\"IC717883365#0000000510290\",\"MSA_AGENT_CODE\":\"717883365\",\"MSA_SEND_TIME\":\"2018-05-15 16:26:10\",\"MSA_RECV_TIME\":\"2018-05-15 18:52:47\",\"MSA_ADD_STATUS\":\"5\",\"MSA_MOD_STATUS\":null,\"MSA_ACCPNO\":\"YCA1805150058\",\"MSA_AUDTNO\":\"YCV1805150041\",\"MSA_ERROR_CODE\":null,\"MSA_REPLY_MEMO\":null,\"CUS_ARRIVAL_PORT_NAME\":\"上海\",\"AUDITNO_7\":\"YSV1805050054\",\"CUS_ARV_ACK_TIME\":\"2018-05-16 02:35:57\",\"CUS_APP_ACK_TIME\":\"2018-05-16 16:00:06\",\"MSA_ACK_TIME\":\"2018-05-15 18:45:00\",\"VERSION\":0,\"CUS_ARV_CHG_TITILE\":null,\"CUS_ARV_CHG_REASON\":null,\"CUS_ARV_CHG_CONTENT\":null,\"CUS_ARV_CHG_MEMO\":null,\"CUS_APP_CHG_TITILE\":null,\"CUS_APP_CHG_REASON\":null,\"CUS_APP_CHG_CONTENT\":null,\"CUS_APP_CHG_MEMO\":null,\"CORP_NAME_CN\":\"上海新海丰集装箱运输有限公司\",\"CUS_MEMO\":null,\"CUS_CUSTOMS_CODE\":\"2225\",\"CUS_CUSTOMS_NAME\":\"外港海关\",\"HAVE_RAD_SUB\":\"N\",\"RAD_SUB_NAME\":\"无\",\"VISIT_EPI_AREA\":\"Y\",\"EPI_AREA_DESC\":\"4.28-5.3菲律宾\",\"TAKE_HEALTHY_MEAS\":\"1\",\"HEALTHY_MEAS_DESC\":\"无\",\"HAVE_ILLEGAL_IMIGRANTS\":\"N\",\"ILLEGAL_IMIGRANTS_DESC\":\"无\",\"HAVE_SICK_ANIMALS\":\"N\",\"SICK_ANIMALS_DESC\":\"无\",\"HAVE_VACCI_CERT\":\"Y\",\"VACCI_CERT_NUM\":18,\"HAVE_HEALTHY_CERT\":\"Y\",\"HEALTHY_CERT_NUM\":18,\"ENTER_APP_NO\":\"310001118693605\",\"CIQ_MEMO\":\"外勤 郝建康13761969211\",\"CIQ_APP_ORG_CODE\":\"310001\",\"CIQ_APP_ORG_NAME\":\"航交所\",\"CIQ_VESSEL_CODE\":19397,\"CIQ_AGENT_CODE\":204,\"CIQ_APLID\":\"310001418693713\",\"CIQ_TRACK_NO\":1,\"CIQ_ADD_STATUS\":\"1\",\"CIQ_SEND_TIME\":\"2018-05-15 17:07:27\",\"CIQ_RECV_TIME\":\"2018-05-15 17:10:17\",\"CIQ_RETURN_MEMO\":null,\"CUS_ARRIVAL_DATE\":\"2018-05-16 02:30:00\",\"CAPXTIMESTAMP\":\"2018-05-17 16:02:07.993698000\",\"CUS_APP_MOD_FILE_NAME\":null,\"CUS_APP_ADD_FILE_NAME\":\"CN_CSM101_1p0_2200_20180516041438538.xml\",\"CUS_ARV_MOD_FILE_NAME\":null,\"CUS_ARV_ADD_FILE_NAME\":\"CN_CSM004_1p0_2200_20180516023908548.xml\",\"NEED_CHECK_SHIP_TAX\":null,\"IS_MIDWAY_STATION\":\"T\",\"MIDWAY_STATION_CODE\":\"AAA\",\"MIDWAY_STATION_NAME\":\"BBBBB\",\"STAFF_TELEPHONE\":\"ST02\",\"BALLAST_WATER_TOTAL\":1,\"BALLAST_WATERPOOL_TOTAL\":2,\"EMISSIONS\":\"E02\",\"BALLAST_WATER_MEMO\":\"BWM01\",\"CUS_121_APLID\":\"C1A01\",\"CUS_121_ADD_STATUS\":\"C1AS01\",\"CUS_121_MOD_STATUS\":\"C1MS01\",\"CUS_121_SEND_TIME\":\"2018-11-01 00:00:00\",\"CUS_121_DEL_TIME\":\"2018-11-02 00:00:00\",\"CUS_121_ACK_TIME\":\"2018-11-03 00:00:00\",\"CUS_121_RECV_TIME\":\"2018-11-04 00:00:00\",\"CUS_121_REPLY_MEMO\":\"C1RM01\",\"CUS_131_APLID\":\"C1AID01\",\"CUS_131_ADD_STATUS\":\"C1ASS01\",\"CUS_131_MOD_STATUS\":\"C1MSS01\",\"CUS_131_SEND_TIME\":\"2018-11-05 00:00:00\",\"CUS_131_DEL_TIME\":\"2018-11-06 00:00:00\",\"CUS_131_ACK_TIME\":\"2018-11-07 00:00:00\",\"CUS_131_RECV_TIME\":\"2018-11-08 00:00:00\",\"CUS_131_REPLY_MEMO\":\"C1RMO01\",\"CUS_141_APLID\":\"C141A01\",\"CUS_141_ADD_STATUS\":\"C141AS01\",\"CUS_141_MOD_STATUS\":\"C141MS02\",\"CUS_141_SEND_TIME\":\"2018-11-09 00:00:00\",\"CUS_141_DEL_TIME\":\"2018-11-10 00:00:00\",\"CUS_141_ACK_TIME\":\"2018-11-11 00:00:00\",\"CUS_141_RECV_TIME\":\"2018-11-12 00:00:00\",\"CUS_141_REPLY_MEMO\":\"C141RMOO01\",\"FOOD_PORT_CODE\":\"CNSHA\",\"FOOD_PORT_NAME\":\"Shanghai\",\"WATER_PORT_CODE\":\"CNSHB\",\"WATER_PORT_NAME\":\"ShangBei\",\"ACCIDENT_DEATH_NUM\":11,\"INFECTIOUS_PATIENTS_NUM\":12,\"OTHER_PATIENTS\":\"OP01\",\"CONSULTATION_DOCTOR\":\"CD01\",\"SSCEC_SSC\":\"SSSC01\",\"SSCEC_SSC_PORT_CODE\":\"CNSHC\",\"SSCEC_SSC_PORT_NAME\":\"ShangCai\",\"SSCEC_SSC_DATE\":\"2018-11-13 00:00:00\",\"IF_IMO\":null,\"NEED_C65\":null,\"NEED_FOOD\":null,\"NEED_WATER\":null,\"IF_EVENT\":null,\"HAS_ANIMAL\":null,\"RISK_MANAGE_MEMO\":null,\"OLD_ID\":null,\"DOWN_UP_NUM\":null,\"CREW_CHANGE_INFO\":null,\"IPRT_TMP_ID\":null,\"USER_NAME_ID\":null,\"VOYAGE_DESC\":null,\"CARGO_DESCRIPTION\":null,\"WASTE_DEMAND\":null,\"FRESH_WATER_GRACE\":null,\"SECURITY_LEVEL\":null,\"DIRECT_SHIP_MARK\":null,\"MSA_FLAG\":null,\"MSA_APPLY_SEQ_NO\":null,\"MSA_DOCK_CODE\":null,\"MSA_DOCK_NAME\":null,\"MSA_SFI_REASON\":null,\"CUS_FLAG\":null,\"DANGEROUS_SHIP_RECEIPT_NO\":null}' as parseData");
    }
}
